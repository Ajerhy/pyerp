{% extends "base/dashboard.html" %}
{% load humanize %}
{% load bootstrap4 %}

{% bootstrap_css %}
{% bootstrap_javascript jquery='full' %}
{% bootstrap_messages %}

{% load i18n static %}
{% load erp_tags %}
{% block header %}
    <link rel="shortcut icon" href="{% static '.' %}/dist/favicon.png" type="image/x-icon"/>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="{% static '/plugins/fontawesome-free/css/all.min.css' %}">
    <!-- Ionicons -->
    <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <!-- Toastr -->
    <link rel="stylesheet" href="{{ STATIC_URL }}plugins/toastr/toastr.min.css">
    <!-- Tempusdominus Bbootstrap 4 -->
    <link rel="stylesheet" href="{% static '/plugins/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css' %}">
    <!-- overlayScrollbars -->
    <link rel="stylesheet" href="{% static '/dist/css/adminlte.min.css' %}">
    <!-- Google Font: Source Sans Pro -->
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/main.css' %}">

    <!-- Admin Libraries -->
    <script type="text/javascript" src="/admin/jsi18n/"></script>
    <script type="text/javascript" src="/static/admin/js/vendor/jquery/jquery.js"></script>
    <script type="text/javascript" src="/static/admin/js/jquery.init.js"></script>
    <script type="text/javascript" src="/static/admin/js/core.js"></script>
    <script type="text/javascript" src="/static/admin/js/inlines.js"></script>

    {{ formset.media }}

    <!-- Bootstrap 4 -->
    <script src="{% static '/plugins/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
    <!-- FastClick -->
    <script src="{% static '/plugins/fastclick/fastclick.js' %}"></script>
    <!-- AdminLTE App -->
    <script src="{% static '/dist/js/adminlte.min.js' %}"></script>
    <!-- Toastr -->
    <script src="{{ STATIC_URL }}plugins/toastr/toastr.min.js"></script>
    <!-- Tempusdominus Bootstrap 4 -->
    <script src="{% static '/plugins/tempusdominus-bootstrap-4/js/tempusdominus-bootstrap-4.min.js' %}"></script>
{% endblock header %}
{% block head %}
<link rel="stylesheet" href="{% static '/bootstrap-select-1.13.9/dist/css/bootstrap-select.min.css' %}">
<style>
  .table .select2-container--default .select2-selection--single, .select2-selection .select2-selection--single {
    padding: 3px 12px;
    height: calc(1.8125rem + 2px);
    -moz-appearance: textfield;
    background-color: transparent;
    border: 0px solid transparent;
  }
  .table .select2-container--default .select2-selection--single .select2-selection__clear {
    display: none;
  }
  .table .select2-container--default .select2-selection--single .select2-selection__arrow b {
    display: none;
  }
  .select2-container--default .select2-selection--multiple {
    background-color: transparent;
    border-radius: 4px;
    cursor: text;
    min-height: 0px;
    border: none;
    height: calc(1.8125rem + 2px);
  }
  .select2-container--default .select2-selection--multiple .select2-selection__choice {
    background-color: #007bff;
    border: 0px solid transparent;
    border-radius: 4px;
    cursor: default;
    float: left;
    margin-right: 5px;
    margin-top: 5px;
    padding: 0 5px;
    font-size: 75%;
  }
  .select2-container--default .select2-search--inline .select2-search__field {
    background: transparent;
    border: none;
    outline: 0;
    box-shadow: none;
    -webkit-appearance: textfield;
      font-size: 75%;

  }
  .bootstrap-select > .dropdown-toggle {
    height: calc(1.8125rem + 2px);
    position: relative;
    width: 100%;
    text-align: right;
    white-space: nowrap;
    display: -webkit-inline-box;
    display: -webkit-inline-flex;
    display: -ms-inline-flexbox;
    display: inline-flex;
    -webkit-box-align: center;
    -webkit-align-items: center;
    -ms-flex-align: center;
    align-items: center;
    -webkit-box-pack: justify;
    -webkit-justify-content: space-between;
    -ms-flex-pack: justify;
    justify-content: space-between;
    background-color: transparent;
    border: 0px solid transparent;
  }
  .bootstrap-select .dropdown-toggle .filter-option {
    height: calc(1.8125rem + 2px);
  }
  .badge {
    font-size: 65%;
    font-weight: bold;
  }
  .dropdown-toggle::after {
    display: inline-block;
    margin-left: .255em;
    vertical-align: .255em;
    content: "";
    border-top: .0px solid;
    border-right: .3em solid transparent;
    border-bottom: 0;
    border-left: .3em solid transparent;

  }
  .dropup .dropdown-toggle::after {

    display: inline-block;
    margin-left: .255em;
    vertical-align: .255em;
    content: "";
    border-top: 0;
    border-right: .3em solid transparent;
    border-bottom: 0;
    border-left: .3em solid transparent;
  }
  /*.table-sm td, .table-sm th {
    padding: 0rem;
    padding-top: 0rem;
    padding-bottom: 0rem;
  }*/
  .table .form-control {
    -moz-appearance: textfield;
    background-color: transparent;
    border: 0px solid transparent;
  }
  .form-control-sm {
    font-size: 75%;
  }
  .form-control:disabled, .form-control[readonly] {
    background-color: transparent;
  }
  input[type=number]::-webkit-inner-spin-button,
  input[type=number]::-webkit-outer-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }
  .custom-select {
    -moz-appearance: textfield;
    background-color: transparent;
    border: 0px solid transparent;
    box-shadow: None;
    background: None;
    padding: 0;
  }
  .table th:last-child, td {
    padding-bottom: 0px !important;
    padding-top: 0px !important;
    /*color: transparent;*/
  }
  .breadcrumb {
    padding: .75rem 1rem .75rem 0rem;
    background-color: Transparent;
  }
  .card-header {
    border-bottom: none;
  }
  .breadcrumb-item a {
    color: #563D7C;
    font-weight: bold;
  }
  .empty-form {
    display: none;
  }
  .inline-group .tabular th.original {
    width: 0px;
    padding: 0;
  }
  .inline-group .tabular tr td.original {
    padding: 0;
    width: 0;
  }
  .table td, .table th {
    padding: 0;
    vertical-align: middle;
    border-top: 1px solid #dee2e6;
  }
</style>
{% endblock %}


{% block content %}
<div class="row" style="padding:5px;" >
  <div class="card card-outline col-12">
    <form method="post" class="form">
      {% csrf_token %}
      <div class="card-header">
        {% include 'account/header.html' %}
      </div>
      <div class="card-body">
        <div class="form-row">
          {% if object %}
            <div class="form-group row col-sm-6">
              <label class="col-sm-2 col-xl-2 col-form-label" for="id_name">Name</label>
              <div class="col-sm-9">
                <input type="text" value="{{ object.name }}" class="form-control"  style="width: 100%"  maxlength="80" disabled >
                <span class="help-block">
                </span>
              </div>
            </div>
          {% else %}
            <div class="form-group row col-sm-6">
              <label class="col-sm-2 col-xl-2 col-form-label" for="id_name">Name</label>
              <div class="col-sm-9">
                <input type="text" value="Nuevo" class="form-control"  style="width: 100%"  maxlength="80" disabled >
                <span class="help-block">
                </span>
              </div>
            </div>
          {% endif %}
          {% for field in form %}
            {% if field.auto_id != "id_note" %}
              <div class="form-group row col-sm-6">
                <label class="col-sm-2 col-xl-2 col-form-label" for="{{ field.id_for_label }}">{{ field.label }}</label>
                <div class="col-sm-9">
                  {{ field }}
                  <span class="help-block">
                    {% for error in field.errors %}
                      <ul>
                        <li class="text-red">{{ error }}</li>
                      </ul>
                    {% endfor %}
                  </span>
                </div>
              </div>
            {% endif %}
          {% endfor %}
        </div>
          <div class="js-inline-admin-formset inline-group" id="{{ formset.prefix }}-group" data-inline-type="tabular" data-inline-formset="{&quot;name&quot;: &quot;#{{ formset.prefix }}&quot;, &quot;options&quot;: {&quot;prefix&quot;: &quot;{{ formset.prefix }}&quot;, &quot;addText&quot;: &quot;{{ _('add accounting note') }}.&quot;, &quot;deleteText&quot;: &quot;Eliminar&quot;}}">
            <div class="tabular inline-related last-related">
              {{ formset.management_form }}
              <fieldset>
                <table  class="table table-bordered table-striped">
                  <thead>
                    <tr>
                      <th class="original"></th>
                      {% for field in formset.form %}
                        {% if not field.widget.is_hidden %}
                          <th class="column-{{ field.name }}">{{ field.label|capfirst }}</th>
                        {% endif %}
                      {% endfor %}
                      {% if formset.can_delete %}<th></th>{% endif %}
                    </tr>
                  </thead>
                  <tbody>
                    {% for inline_form in formset %}
                      <tr class="{% cycle 'row1' 'row2' %}" id="{{ formset.prefix }}-{{ forloop.counter0 }}">
                        <td class="original {%if field.errors %}table-danger{% endif %}">
                          {% for hidden in inline_form.hidden_fields %}
                            {{ hidden }}
                          {% endfor %}
                        </td>
                        {% for field in inline_form.visible_fields %}
                          <td {% if field.name %} class="field-{{ field.name }}"{% endif %}>
                              {{ field }}
                          </td>
                        {% endfor %}
                      </tr>
                    {% endfor %}
                    <tr class="row1  empty-form" id="{{ formset.prefix }}-empty">
                      <td class="original {%if field.errors %}table-danger{% endif %}">
                        <input type="hidden" name="{{ formset.prefix }}-__prefix__-id" id="id_{{ formset.prefix }}-__prefix__-id">
                        <input type="hidden" name="{{ formset.prefix }}-__prefix__-account_move_id" id="id_{{ formset.prefix }}-__prefix__-account_move_id">
                      </td>
                      <td class="field-account_plan_id {%if field.errors %}table-danger{% endif %}">
                        <div class="related-widget-wrapper">
                          <select name="{{ formset.prefix }}-__prefix__-account_plan_id" class="form-control" data-placeholder="Select an account" id="id_{{ formset.prefix }}-__prefix__-account_plan_id" data-autocomplete-light-language="es" data-autocomplete-light-url="/account/plan/autocomplete" data-autocomplete-light-function="select2">
                            <option value="" selected>---------</option>
                          </select>
                        </div>
                      </td>
                      <td class="field-reference_company {%if field.errors %}table-danger{% endif %}">
                        <div class="related-widget-wrapper">
                          <select name="{{ formset.prefix }}-__prefix__-reference_company" class="form-control" data-placeholder="Select a company" id="id_{{ formset.prefix }}-__prefix__-reference_company" data-autocomplete-light-language="es" data-autocomplete-light-url="/company/autocomplete" data-autocomplete-light-function="select2">
                            <option value="" selected>---------</option>
                          </select>
                        </div>
                      </td>
                      <td class="field-tags {%if field.errors %}table-danger{% endif %}">
                          <input type="text" name="{{ formset.prefix }}-__prefix__-tags" class="form-control" placeholder="----------" id="id_{{ formset.prefix }}-__prefix__-tags">
                      </td>
                      <td class="field-debit {%if field.errors %}table-danger{% endif %}">
                          <input type="number" name="{{ formset.prefix }}-__prefix__-debit" value="0" class="form-control" data-placeholder="Debit" step="0.01" id="id_{{ formset.prefix }}-__prefix__-debit">
                      </td>
                      <td class="field-credit {%if field.errors %}table-danger{% endif %}">
                          <input type="number" name="{{ formset.prefix }}-__prefix__-credit" value="0" class="form-control" data-placeholder="Credit" step="0.01" id="id_{{ formset.prefix }}-__prefix__-credit">
                      </td>
                      <td class="field-date_due {%if field.errors %}table-danger{% endif %}">
                        <div class="input-group" id="div_id_{{ formset.prefix }}___prefix___date_due" data-target-input="nearest">
                          <input type="text" name="{{ formset.prefix }}-__prefix__-date_due" id="id_{{ formset.prefix }}___prefix___date_due" class="form-control  datetimepicker-input" data-toggle="datetimepicker" data-target="#id_{{ formset.prefix }}___prefix___date_due">
                        </div>
                        <script type="text/javascript">
                            "use strict";
                            var name = "foo";
                            var __prefix__ = document.getElementById('id_{{ formset.prefix }}-INITIAL_FORMS').value
                            var func = new Function(
                                "return \
                                  function deferDateTimePicker_id_{{ formset.prefix }}_" + __prefix__ + "_date_due(){ \
                                    if (window.jQuery && $.fn.datetimepicker) { \
                                      $('#id_pyaccountmovedetail_set___prefix___date_due').datetimepicker({'format': 'L', 'useCurrent': true, 'collapse': true, 'date': '2019-10-25T14:42:27'}); \
                                    } else { \
                                      setTimeout(function() { deferDateTimePicker_id_{{ formset.prefix }}_" + __prefix__ + "_date_due() }, 50); \
                                    } \
                                  }"
                            )();

                            //call it, to test it
                            func();
                        </script>
                      </td>
                      <td class="delete {%if field.errors %}table-danger{% endif %}"></td>
                    </tr>
                  </tbody>
                </table>
              </fieldset>
            </div>
          </div>
      </div>
      <!-- /.card-body -->
      <div class="card-footer">
      </div>
      <!-- /.card-footer -->
    </div>
    <!-- /.card -->
  </form>
</div>
{% endblock content %}
